<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>éƒ¨æ´»äººç”Ÿã‚²ãƒ¼ãƒ </title>

<style>
body{
  text-align:center;
  font-family:sans-serif;
}

#board{
  display:grid;
  grid-template-columns:repeat(7,80px);
  gap:5px;
  justify-content:center;
  margin:20px;
}

.square{
  border:2px solid black;
  height:80px;
  position:relative;
  font-size:12px;
}

.playerToken{
  width:14px;
  height:14px;
  border-radius:50%;
  display:inline-block;
  margin:2px;
  border:2px solid white;
}

#moneyArea{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:10px;
  margin:15px 0;
}

.moneyCard{
  padding:8px 12px;
  border-radius:10px;
  background:#f5f5f5;
  border:2px solid #333;
  font-size:14px;
}

.activeTurn{
  transform:scale(1.1);
  background:#ffeaa7;
}

.modal{
  display:none;
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:rgba(0,0,0,0.5);
}

.modalContent{
  background:white;
  padding:20px;
  margin:100px auto;
  width:300px;
}
</style>
</head>

<body>

<h1>ğŸ¾ éƒ¨æ´»äººç”Ÿã‚²ãƒ¼ãƒ  ğŸ²</h1>

<div id="board"></div>

<button onclick="rollDice()">ğŸ² ã‚µã‚¤ã‚³ãƒ­</button>

<h2>ğŸ’° æ‰€æŒé‡‘</h2>
<div id="moneyArea"></div>

<div id="resultModal" class="modal">
  <div class="modalContent">
    <h2>ğŸ† æœ€çµ‚çµæœ ğŸ†</h2>
    <div id="rankingArea"></div>
  </div>
</div>

<script>

// ===== ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½œæˆ =====
let playerCount = parseInt(prompt("ä½•äººã§éŠã¶ï¼Ÿï¼ˆæœ€å¤§14äººï¼‰"));
if(playerCount>14) playerCount=14;

const playerColors=[
"red","blue","green","orange","purple",
"pink","brown","black","gold","cyan",
"lime","magenta","gray","navy"
];

let players=[];
for(let i=0;i<playerCount;i++){
  let name=prompt((i+1)+"äººç›®ã®åå‰");
  players.push({
    name:name,
    position:0,
    money:0,
    finished:false,
    color:playerColors[i]
  });
}

let currentPlayer=0;

// ===== ç›¤é¢è¨­å®š =====
const board=[
"start",
"normal","normal","reward","normal","mini","normal","warp",
"normal","normal","reward","normal","mini","normal","warp",
"normal","reward","normal","mini","normal","warp",
"normal","normal","reward","mini","normal","warp",
"normal","reward","normal","mini","normal","warp",
"normal","goal"
];

// é€šå¸¸ãƒã‚¹ä½ç½®ï¼ˆ0ã‚¹ã‚¿ãƒ¼ãƒˆï¼‰
const normalSquares=[
1,2,4,6,8,9,11,13,15,17,
19,21,22,25,27,29,31,33
];

// é€šå¸¸ã‚¤ãƒ™ãƒ³ãƒˆ18å€‹
const normalEvents=[

{ text:"ã‚¹ãƒãƒƒã‚·ãƒ¥ã§ãƒ©ã‚±ãƒƒãƒˆç²‰ç •ã€‚è²·ã„æ›¿ãˆã€‚", money:-20000 },
{ text:"ç·´ç¿’è¡Œã“ã†ã¨ã—ãŸã‚‰ãƒ‘ãƒ³ã‚¯ã€‚", money:-2000 },
{ text:"ãƒ©ã‚¤ãƒ³ã«èº“ã„ã¦ãƒ­ãƒ¼ãƒªãƒ³ã‚°å¤§çˆ†ç¬‘ã€‚", money:0 },
{ text:"ä¸­å›½å¤§ä¼šå‡ºå ´æ±ºå®šï¼", money:5000 },
{ text:"å…ˆè¼©ã«æ€’ã‚‰ã‚Œã‚‹ã€‚", money:-1000 },
{ text:"ã†ã‚‹ã•ãã—ã™ãã¦ãŠã°ã•ã‚“ç™»å ´ã€‚", money:-2000 },
{ text:"è©¦åˆã«å‹åˆ©ï¼", money:3000 },
{ text:"è©¦åˆã«æ•—åŒ—ã€‚", money:-2000 },
{ text:"é›¨ã§ã‚ªãƒ•ã€‚", money:0 },
{ text:"é›ªãŒé™ã£ã¦ãƒ†ãƒ³ã‚·ãƒ§ãƒ³çˆ†ä¸Šã’ã€‚", money:1000 },
{ text:"ãƒ©ã‚±ãƒƒãƒˆã‚’ã™ã­ã«å½“ã¦ã¦çµ¶å«ã€‚", money:-1000 },
{ text:"ãƒŸã‚¹ã£ã¦ç™ºç‹‚ã€‚", money:-1000 },
{ text:"ã‚¹ã‚³ã‚¢ãŒãƒ—ãƒ©ã‚¹ã§å–œã¶ã€‚", money:2000 },
{ text:"ã‚¹ã‚³ã‚¢ãŒãƒã‚¤ãƒŠã‚¹ã§æ‚²ã—ã‚€ã€‚", money:-1500 },
{ text:"OBã‹ã‚‰å·®ã—å…¥ã‚Œï¼", money:3000 },
{ text:"ãƒ©ã‚±ãƒƒãƒˆã®ã‚¬ãƒƒãƒˆå¼µã‚Šæ›¿ãˆã€‚", money:-2000 },
{ text:"ã‚µãƒ¼ãƒ–ã®ãƒ•ã‚©ãƒ¼ãƒ è¿·èµ°ä¸­ã€‚", money:-1000 },
{ text:"é¡§å•ã«è¤’ã‚ã‚‰ã‚Œã‚‹ã€‚", money:1000 }

];

// ===== ç›¤é¢æç”» =====
const boardDiv=document.getElementById("board");

board.forEach((type,index)=>{
  const square=document.createElement("div");
  square.className="square";
  square.id="square"+index;

  if(type==="normal") square.style.background="white";
  if(type==="reward") square.style.background="yellow";
  if(type==="mini") square.style.background="red";
  if(type==="warp") square.style.background="lightblue";
  if(type==="start") square.style.background="lightgreen";
  if(type==="goal") square.style.background="lightgray";

  square.innerHTML=(index+1);
  boardDiv.appendChild(square);
});

// ===== è¡¨ç¤ºæ›´æ–° =====
function updateBoard(){

  document.querySelectorAll(".playerToken").forEach(el=>el.remove());

  players.forEach(p=>{
    const square=document.getElementById("square"+p.position);
    if(square){
      const token=document.createElement("div");
      token.className="playerToken";
      token.style.backgroundColor=p.color;
      token.title=p.name;
      square.appendChild(token);
    }
  });
}

function updateMoneyDisplay(){

  const area=document.getElementById("moneyArea");
  area.innerHTML="";

  players.forEach((p,i)=>{
    const card=document.createElement("div");
    card.className="moneyCard";
    if(i===currentPlayer) card.classList.add("activeTurn");

    card.innerHTML=`
      <div style="color:${p.color}; font-weight:bold;">
        â— ${p.name}
      </div>
      ğŸ’° ${p.money}å††
    `;

    area.appendChild(card);
  });
}

// ===== ã‚µã‚¤ã‚³ãƒ­ =====
function rollDice(){

  if(players[currentPlayer].finished) return;

  const dice=Math.floor(Math.random()*6)+1;
  alert(players[currentPlayer].name+" ã¯ "+dice+" ãƒã‚¹é€²ã‚€");

  players[currentPlayer].position+=dice;

  if(players[currentPlayer].position>=34){
    players[currentPlayer].position=34;
    players[currentPlayer].finished=true;
  }

  handleSquare();
  updateBoard();
}

// ===== ãƒã‚¹å‡¦ç† =====
function handleSquare(){

  const player=players[currentPlayer];
  const squareType=board[player.position];

  if(squareType==="normal"){
    const index=normalSquares.indexOf(player.position);
    const event=normalEvents[index];
    alert(event.text);
    player.money+=event.money;
    updateMoneyDisplay();
    nextTurn();
    return;
  }

  if(squareType==="reward"){
    spinReward();
    return;
  }

  if(squareType==="mini"){
    alert("ãƒŸãƒ‹ã‚²ãƒ¼ãƒ ç™ºç”Ÿï¼");
    nextTurn();
    return;
  }

  if(squareType==="warp"){
    const move=Math.floor(Math.random()*3)+1;
    if(Math.random()<0.5){
      player.position+=move;
      alert("ãƒ¯ãƒ¼ãƒ—ã§ "+move+" ãƒã‚¹é€²ã‚“ã ï¼");
    }else{
      player.position-=move;
      if(player.position<0) player.position=0;
      alert("ãƒ¯ãƒ¼ãƒ—ã§ "+move+" ãƒã‚¹æˆ»ã£ãŸï¼");
    }
    updateBoard();
    nextTurn();
    return;
  }

  if(squareType==="goal"){
    alert(player.name+" ã‚´ãƒ¼ãƒ«ï¼");
    nextTurn();
    checkGameEnd();
  }
}

// ===== ã”è¤’ç¾ =====
function spinReward(){

  const rewards=[
  {text:"+3000å††",money:3000},
  {text:"+5000å††",money:5000},
  {text:"+10000å††",money:10000},
  {text:"ã‚¸ãƒ¥ãƒ¼ã‚¹ç²å¾—",money:0},
  {text:"ãŠè“å­ç²å¾—",money:0}
  ];

  const result=rewards[Math.floor(Math.random()*rewards.length)];

  alert("ã”è¤’ç¾ï¼ "+result.text);

  players[currentPlayer].money+=result.money;

  updateMoneyDisplay();
  nextTurn();
}

// ===== ã‚¿ãƒ¼ãƒ³ =====
function nextTurn(){
  currentPlayer++;
  if(currentPlayer>=players.length) currentPlayer=0;
  updateMoneyDisplay();
}

// ===== çµ‚äº†åˆ¤å®š =====
function checkGameEnd(){

  if(players.every(p=>p.finished)){
    showRanking();
  }
}

function showRanking(){

  const modal=document.getElementById("resultModal");
  const area=document.getElementById("rankingArea");

  const ranking=[...players].sort((a,b)=>b.money-a.money);

  area.innerHTML="";
  ranking.forEach((p,i)=>{
    area.innerHTML+=`<div>${i+1}ä½ ${p.name} ğŸ’°${p.money}å††</div>`;
  });

  modal.style.display="block";
  document.querySelector("button").disabled=true;
}

updateBoard();
updateMoneyDisplay();

</script>
</body>
</html>
