<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>éƒ¨æ´»äººç”Ÿã‚²ãƒ¼ãƒ ï¼šãƒ†ãƒ‹ã‚¹ç·¨</title>

<style>
  :root {
    --court-green: #2e8b57;
    --line-white: #ffffff;
    --clay-orange: #d2691e;
  }

  body {
    text-align: center;
    font-family: 'Helvetica Neue', Arial, "Hiragino Kaku Gothic ProN", "Meiryo", sans-serif;
    background-color: #f0f4f0;
    margin: 0;
    padding: 20px;
  }

  h1 { color: var(--court-green); margin-bottom: 10px; }

  /* ã‚µã‚¤ã‚³ãƒ­ã‚¨ãƒªã‚¢ */
  #diceContainer {
    margin-bottom: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
  }

  #diceDisplay {
    width: 60px;
    height: 60px;
    line-height: 60px;
    font-size: 32px;
    background: white;
    border: 3px solid var(--court-green);
    border-radius: 10px;
    font-weight: bold;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  }

  /* ã‚¤ãƒ™ãƒ³ãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ */
  #eventArea {
    min-height: 40px;
    max-width: 800px;
    margin: 10px auto 20px;
    padding: 15px;
    background: #fffbe6;
    border-left: 10px solid #f1c40f;
    font-weight: bold;
    font-size: 1.1rem;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }

  /* ãƒœãƒ¼ãƒ‰ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
  #board {
    display: grid;
    /* 7åˆ—ã€å„120pxã«åºƒã’ã¾ã—ãŸ */
    grid-template-columns: repeat(7, 125px); 
    gap: 10px;
    justify-content: center;
    margin: 20px auto;
    background: #ccc; /* é“è·¯ï¼ˆéš™é–“ï¼‰ã®è‰² */
    padding: 15px;
    border-radius: 8px;
  }

  .square {
    border: 2px solid var(--line-white);
    min-height: 110px; /* é«˜ã•ã‚’ç¢ºä¿ */
    position: relative;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start; /* ä¸Šè©°ã‚ã§è¡¨ç¤º */
    padding: 8px 4px;
    box-sizing: border-box;
    border-radius: 4px;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
  }

  /* ãƒã‚¹ã®è‰²åˆ†ã‘ */
  .type-start  { background-color: #27ae60 !important; }
  .type-normal { background-color: var(--court-green); }
  .type-reward { background-color: #f1c40f; color: #333 !important; }
  .type-mini   { background-color: #e74c3c; }
  .type-warp   { background-color: #3498db; }
  .type-goal   { background-color: #2c3e50; }

  .square-num { font-size: 12px; margin-bottom: 4px; border-bottom: 1px solid rgba(255,255,255,0.5); width: 100%; }
  .square-text { font-size: 12px; font-weight: bold; line-height: 1.3; word-break: break-all; margin-bottom: 5px;}
  .square-price { font-size: 11px; background: rgba(0,0,0,0.2); padding: 1px 4px; border-radius: 3px; }

  /* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é§’ */
  .token-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: auto; /* ä¸‹å´ã«é…ç½® */
    min-height: 20px;
    width: 100%;
  }

  .playerToken {
    width: 15px;
    height: 15px;
    border-radius: 50%;
    margin: 1px;
    border: 2px solid white;
    box-shadow: 0 0 3px rgba(0,0,0,0.5);
  }

  /* æ‰€æŒé‡‘ã‚¨ãƒªã‚¢ */
  #moneyArea { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 20px; }
  .moneyCard {
    padding: 10px;
    border-radius: 8px;
    background: white;
    border: 2px solid #ddd;
    min-width: 110px;
  }
  .activeTurn { border: 4px solid var(--court-green) !important; transform: scale(1.1); z-index: 5; }

  button {
    padding: 15px 30px;
    font-size: 18px;
    background: var(--court-green);
    color: white;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 4px #1e5d3a;
  }
  button:disabled { background: #ccc; box-shadow: none; }

  .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:100; }
  .modalContent { background:white; padding:30px; margin:80px auto; width:300px; border-radius:20px; }
</style>
</head>
<body>

<h1>ğŸ¾ éƒ¨æ´»äººç”Ÿã‚²ãƒ¼ãƒ ï¼šãƒ†ãƒ‹ã‚¹ç·¨ ğŸ²</h1>

<div id="diceContainer">
  <div id="diceDisplay">?</div>
  <button id="diceBtn" onclick="rollDice()">ğŸ² ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚‹</button>
</div>

<div id="eventArea">éƒ¨æ´»ã¸ã‚ˆã†ã“ãï¼ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã£ã¦ã­ã€‚</div>

<div id="board"></div>

<h2>ğŸ’° ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±</h2>
<div id="moneyArea"></div>

<div id="resultModal" class="modal">
  <div class="modalContent">
    <h2>ğŸ† æœ€çµ‚æˆç¸¾ ğŸ†</h2>
    <div id="rankingArea" style="text-align:left; font-size:18px;"></div>
    <button style="margin-top:20px" onclick="location.reload()">ã‚‚ã†ä¸€åº¦éŠã¶</button>
  </div>
</div>

<script>
// ===== ãƒ‡ãƒ¼ã‚¿è¨­å®š =====
const boardConfig = [
  {type:"start", text:"ã‚¹ã‚¿ãƒ¼ãƒˆ"},
  {type:"normal", text:"ãƒ©ã‚±ãƒƒãƒˆç²‰ç •", money:-20000},
  {type:"normal", text:"è‡ªè»¢è»Šãƒ‘ãƒ³ã‚¯", money:-2000},
  {type:"reward", text:"OBã®å·®ã—å…¥ã‚Œ", money:3000},
  {type:"normal", text:"å¤§ä¼šå‡ºå ´æ±ºå®š", money:5000},
  {type:"mini", text:"ç¾å®ŸãƒŸãƒ‹ã‚²ãƒ¼ãƒ ", money:0},
  {type:"normal", text:"å…ˆè¼©ã«æ€’ã‚‰ã‚Œã‚‹", money:-1000},
  {type:"warp", text:"ãƒ¯ãƒ¼ãƒ—ï¼"},
  {type:"normal", text:"è©¦åˆã«å‹åˆ©ï¼", money:3000},
  {type:"normal", text:"ç·´ç¿’è©¦åˆæ•—åŒ—", money:-2000},
  {type:"reward", text:"ãƒ‰ãƒªãƒ³ã‚¯ç²å¾—", money:500},
  {type:"normal", text:"é›¨ã§ã‚ªãƒ•", money:0},
  {type:"mini", text:"ç¾å®ŸãƒŸãƒ‹ã‚²ãƒ¼ãƒ ", money:0},
  {type:"normal", text:"é›ªã§ç­‹ãƒˆãƒ¬", money:-1000},
  {type:"warp", text:"ãƒ¯ãƒ¼ãƒ—ï¼"},
  {type:"normal", text:"ãƒ•ã‚©ãƒ¼ãƒ è¿·èµ°", money:-1000},
  {type:"reward", text:"è‡¨æ™‚ãƒœãƒ¼ãƒŠã‚¹", money:10000},
  {type:"normal", text:"ãƒŸã‚¹ã§ç™ºç‹‚", money:-1000},
  {type:"mini", text:"ç¾å®ŸãƒŸãƒ‹ã‚²ãƒ¼ãƒ ", money:0},
  {type:"normal", text:"ã‚¹ã‚³ã‚¢ãƒ—ãƒ©ã‚¹", money:2000},
  {type:"warp", text:"ãƒ¯ãƒ¼ãƒ—ï¼"},
  {type:"normal", text:"ã‚¹ã‚³ã‚¢ãƒã‚¤ãƒŠã‚¹", money:-1500},
  {type:"normal", text:"ã‚¬ãƒƒãƒˆå¼µæ›¿", money:-2000},
  {type:"reward", text:"ãŠè“å­ç²å¾—", money:300},
  {type:"mini", text:"ç¾å®ŸãƒŸãƒ‹ã‚²ãƒ¼ãƒ ", money:0},
  {type:"normal", text:"é¡§å•ã«è¤’ã‚ã‚‰ã‚Œã‚‹", money:1000},
  {type:"warp", text:"ãƒ¯ãƒ¼ãƒ—ï¼"},
  {type:"normal", text:"ã‚µãƒ¼ãƒ–è¿·èµ°", money:-1000},
  {type:"reward", text:"éƒ¨è²»ã®ä½™ã‚Š", money:5000},
  {type:"normal", text:"ã™ã­ã«ã¶ã¤ã‘ã‚‹", money:-1000},
  {type:"mini", text:"ç¾å®ŸãƒŸãƒ‹ã‚²ãƒ¼ãƒ ", money:0},
  {type:"normal", text:"æœ€é«˜ã®ä¸€æ‰“", money:2000},
  {type:"goal", text:"å¼•é€€ï¼ãŠç–²ã‚Œæ§˜"}
];

// ===== åˆæœŸè¨­å®š =====
let playerCount = parseInt(prompt("äººæ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„(1-14)")) || 1;
if(playerCount > 14) playerCount = 14;

const playerColors = ["#ff4757","#2f3542","#2ed573","#ffa502","#a29bfe","#fd79a8","#8b4513","#333","#ffd700","#0fbcf9","#00d2d3","#f368e0","#636e72","#0652DD"];
let players = [];
for(let i=0; i<playerCount; i++){
  let name = prompt((i+1) + "äººç›®ã®åå‰") || "éƒ¨å“¡" + (i+1);
  players.push({ name: name, position: 0, money: 0, finished: false, color: playerColors[i] });
}

let currentPlayer = 0;
let isRolling = false;

// ===== ãƒœãƒ¼ãƒ‰æç”» =====
const boardDiv = document.getElementById("board");
boardConfig.forEach((cell, i) => {
  const square = document.createElement("div");
  square.className = `square type-${cell.type}`;
  square.id = `square${i}`;
  
  let moneyDisp = cell.money ? `<div class="square-price">${cell.money > 0 ? '+' : ''}${cell.money}å††</div>` : "";
  square.innerHTML = `
    <div class="square-num">${i}</div>
    <div class="square-text">${cell.text}</div>
    ${moneyDisp}
    <div class="token-container" id="container${i}"></div>
  `;
  boardDiv.appendChild(square);
});

function updateDisplay() {
  // é§’ã®ç§»å‹•
  document.querySelectorAll(".playerToken").forEach(el => el.remove());
  players.forEach(p => {
    const container = document.getElementById(`container${p.position}`);
    if(container) {
      const token = document.createElement("div");
      token.className = "playerToken";
      token.style.backgroundColor = p.color;
      container.appendChild(token);
    }
  });

  // æ‰€æŒé‡‘ã®æ›´æ–°
  const area = document.getElementById("moneyArea");
  area.innerHTML = "";
  players.forEach((p, i) => {
    const card = document.createElement("div");
    card.className = "moneyCard" + (i === currentPlayer ? " activeTurn" : "");
    if(p.finished) card.style.opacity = "0.5";
    card.innerHTML = `<b style="color:${p.color}">â— ${p.name}</b><br>ğŸ’° ${p.money}å††`;
    area.appendChild(card);
  });
}

// ===== ã‚µã‚¤ã‚³ãƒ­ã‚’æŒ¯ã‚‹ =====
function rollDice() {
  if(isRolling) return;
  const p = players[currentPlayer];
  if(p.finished) { checkNextTurn(); return; }

  isRolling = true;
  document.getElementById("diceBtn").disabled = true;
  const diceEl = document.getElementById("diceDisplay");
  
  // ã‚µã‚¤ã‚³ãƒ­ãŒå›ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
  let count = 0;
  const timer = setInterval(() => {
    diceEl.innerText = Math.floor(Math.random() * 6) + 1;
    count++;
    if(count > 12) {
      clearInterval(timer);
      const val = Math.floor(Math.random() * 6) + 1;
      diceEl.innerText = val;
      executeMove(val);
    }
  }, 50);
}

function executeMove(steps) {
  const p = players[currentPlayer];
  p.position += steps;

  // ã‚´ãƒ¼ãƒ«å‡¦ç†
  if(p.position >= boardConfig.length - 1) {
    p.position = boardConfig.length - 1;
    p.finished = true;
  }

  const cell = boardConfig[p.position];
  let message = `${p.name}ã¯ ${steps} é€²ã‚“ã§ ã€Œ${cell.text}ã€ï¼`;

  // ãƒã‚¹åŠ¹æœ
  if(cell.money) {
    p.money += cell.money;
  } else if(cell.type === "warp") {
    const jump = Math.floor(Math.random() * 2) + 1;
    if(Math.random() > 0.5) {
      p.position = Math.min(p.position + jump, boardConfig.length - 1);
      message += ` ã•ã‚‰ã« ${jump}ãƒã‚¹é€²ã‚€ï¼`;
    } else {
      p.position = Math.max(p.position - jump, 0);
      message += ` æ®‹å¿µ... ${jump}ãƒã‚¹æˆ»ã‚‹ã€‚`;
    }
  } else if(cell.type === "mini") {
    message += "ã€ç¾å®Ÿã§ãƒŸãƒ‹ã‚²ãƒ¼ãƒ ï¼ã€‘";
  }

  document.getElementById("eventArea").innerText = message;
  updateDisplay();
  
  setTimeout(() => {
    isRolling = false;
    document.getElementById("diceBtn").disabled = false;
    checkGameEnd();
    checkNextTurn();
  }, 1000);
}

function checkNextTurn() {
  if(players.every(pl => pl.finished)) return;
  do {
    currentPlayer = (currentPlayer + 1) % players.length;
  } while (players[currentPlayer].finished);
  updateDisplay();
}

function checkGameEnd() {
  if(players.every(p => p.finished)) {
    const modal = document.getElementById("resultModal");
    const area = document.getElementById("rankingArea");
    const ranking = [...players].sort((a, b) => b.money - a.money);
    area.innerHTML = ranking.map((p, i) => `<div>${i+1}ä½ï¼š<b>${p.name}</b> (${p.money}å††)</div>`).join("");
    modal.style.display = "block";
  }
}

// èµ·å‹•
updateDisplay();
</script>
</body>
</html>
